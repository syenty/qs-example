# BullMQ & Bull Board ν μ‹κ°ν™” μμ 

μ΄ ν”„λ΅μ νΈλ” `BullMQ`λ¥Ό μ‚¬μ©ν•μ—¬ λ°±κ·ΈλΌμ΄λ“ μ‘μ—…μ„ μ²λ¦¬ν•λ” ν(Queue)λ¥Ό κµ¬ν„ν•κ³ , `@bull-board/express`λ¥Ό μ΄μ©ν•΄ ν•΄λ‹Ή νμ μƒνƒλ¥Ό μ‹κ°μ μΌλ΅ λ¨λ‹ν„°λ§ν•λ” λ€μ‹λ³΄λ“λ¥Ό μ κ³µν•λ” κ°„λ‹¨ν• μμ μ…λ‹λ‹¤. `docker-compose`λ¥Ό ν†µν•΄ λ¨λ“  μ„λΉ„μ¤λ¥Ό μ‰½κ² λ°°ν¬ν•κ³  μ‹¤ν–‰ν•  μ μλ„λ΅ κµ¬μ„±λμ–΄ μμµλ‹λ‹¤.

## β¨ μ£Όμ” κΈ°λ¥

- **μ‘μ—… ν κµ¬ν„**: `BullMQ`λ¥Ό μ‚¬μ©ν•μ—¬ μ•μ •μ μ΄κ³  λΉ λ¥Έ λ©”μ‹μ§€ νλ¥Ό μƒμ„±ν•©λ‹λ‹¤.
- **ν λ°μ΄ν„° μ²λ¦¬**: νμ— μ¶”κ°€λ μ‘μ—…μ„ μ²λ¦¬ν•λ” μ›μ»¤(Worker)λ¥Ό κµ¬ν„ν•©λ‹λ‹¤.
- **μ‹κ°ν™” λ€μ‹λ³΄λ“**: `@bull-board/ui`λ¥Ό ν†µν•΄ νμ μƒνƒ(λ€κΈ°, μ§„ν–‰, μ™„λ£, μ‹¤ν¨ λ“±)λ¥Ό μ‹¤μ‹κ°„μΌλ΅ ν™•μΈν•  μ μλ” μ›Ή UIλ¥Ό μ κ³µν•©λ‹λ‹¤.
- **μ‘μ—… μ¶”κ°€ λ° κ΄€λ¦¬ API**: `Express` μ„λ²„λ¥Ό ν†µν•΄ νμ— μ‘μ—…μ„ μ¶”κ°€ν•κ³ , μƒνƒλ³„λ΅ μ΅°νν•λ©°, μ •λ¦¬ν•λ” REST APIλ¥Ό μ κ³µν•©λ‹λ‹¤.
- **Express μ—°λ™**: `Express` μ›Ή μ„λ²„μ— Bull Board λ€μ‹λ³΄λ“λ¥Ό μ‰½κ² ν†µν•©ν•©λ‹λ‹¤.
- **Docker Compose**: Redis, Producer, Worker, Dashboard μ„λΉ„μ¤λ¥Ό ν• λ²μ— μ‰½κ² μ‹¤ν–‰ν•κ³  κ΄€λ¦¬ν•  μ μμµλ‹λ‹¤.

## π› οΈ μ£Όμ” μμ΅΄μ„±

`package.json`μ— λ…μ‹λ μ£Όμ” λΌμ΄λΈλ¬λ¦¬λ” λ‹¤μκ³Ό κ°™μµλ‹λ‹¤.

- `express`: μ›Ή μ„λ²„ ν”„λ μ„μ›ν¬
- `bullmq`: Redis κΈ°λ°μ λΉ λ¥΄κ³  κ°•λ ¥ν• ν λΌμ΄λΈλ¬λ¦¬
- `ioredis`: κ³ μ„±λ¥ Redis ν΄λΌμ΄μ–ΈνΈ
- `@bull-board/api`, `@bull-board/express`, `@bull-board/ui`: Bull/BullMQ νλ¥Ό μ„ν• μ‹κ°ν™” λ€μ‹λ³΄λ“

## β™οΈ μ‹μ‘ν•κΈ°

### μ‚¬μ „ μ¤€λΉ„ μ‚¬ν•­

- **Node.js** (v14 μ΄μƒ κ¶μ¥)
- **npm** λλ” **yarn**
- **Docker** λ° **Docker Compose** (λ¨λ“  μ„λΉ„μ¤λ¥Ό ν• λ²μ— μ‹¤ν–‰ν•κΈ° μ„ν•΄ ν•„μ”ν•©λ‹λ‹¤.)

### π“¦ μ„¤μΉ λ° μ‹¤ν–‰

1.  **ν”„λ΅μ νΈ ν΄λ΅ **

    ```bash
    git clone [ν”„λ΅μ νΈ-μ €μ¥μ†-URL]
    cd [ν”„λ΅μ νΈ-λ””λ ‰ν† λ¦¬λ…]
    ```

2.  **μμ΅΄μ„± μ„¤μΉ**

    ```bash
    npm install
    ```

3.  **Docker Composeλ΅ λ¨λ“  μ„λΉ„μ¤ μ‹¤ν–‰**

    ν”„λ΅μ νΈ λ£¨νΈ λ””λ ‰ν† λ¦¬μ—μ„ λ‹¤μ λ…λ Ήμ–΄λ¥Ό μ‹¤ν–‰ν•μ—¬ Redis, Producer, Worker, Dashboard μ„λΉ„μ¤λ¥Ό λ¨λ‘ μ‹μ‘ν•©λ‹λ‹¤.

    ```bash
    docker-compose up --build
    ```

    > **μ°Έκ³ **: `worker.js` νμΌμ΄ μ΅΄μ¬ν•μ§€ μ•λ” κ²½μ°, `worker` μ„λΉ„μ¤λ” μ¤λ¥λ¥Ό λ°μƒμ‹ν‚¤κ±°λ‚ μΆ…λ£λ  μ μμµλ‹λ‹¤. μ‹¤μ  μ‘μ—…μ„ μ²λ¦¬ν•λ ¤λ©΄ `worker.js` νμΌμ„ κµ¬ν„ν•΄μ•Ό ν•©λ‹λ‹¤. (μ: `new Worker('email-queue', async job => { console.log('Processing job:', job.data); }, { connection });`)

    λ¨λ“  μ„λΉ„μ¤κ°€ μ„±κ³µμ μΌλ΅ μ‹μ‘λλ©΄, λ‹¤μκ³Ό κ°™μ€ λ©”μ‹μ§€λ¥Ό μ½μ†”μ—μ„ ν™•μΈν•  μ μμµλ‹λ‹¤.

    ```
    [Producer] API server listening on port 4000
    [Dashboard] Bull Board server is running on http://localhost:3000/admin/queues
    ```

## π€ μ‚¬μ©λ²•

`docker-compose up` λ…λ Ήμ–΄λ΅ λ¨λ“  μ„λΉ„μ¤κ°€ μ‹¤ν–‰λ ν›„, μ›Ή λΈλΌμ°μ €λ‚ API ν΄λΌμ΄μ–ΈνΈλ¥Ό ν†µν•΄ ν”„λ΅μ νΈλ¥Ό μ‚¬μ©ν•  μ μμµλ‹λ‹¤.

### 1. μ‘μ—… μ¶”κ°€ λ° κ΄€λ¦¬ (Producer API)

`producer` μ„λΉ„μ¤λ” `localhost:4000` ν¬νΈμ—μ„ μ‹¤ν–‰λ©λ‹λ‹¤.

- **μ‘μ—… μ¶”κ°€ (POST)**:
  `http://localhost:4000/jobs` μ—”λ“ν¬μΈνΈλ΅ `POST` μ”μ²­μ„ λ³΄λ‚΄ νμ— μ‘μ—…μ„ μ¶”κ°€ν•©λ‹λ‹¤.

  **μμ‹ (cURL):**

  ```bash
  curl -X POST -H "Content-Type: application/json" -d '{"name": "send-email", "data": {"to": "test@example.com", "subject": "Hello BullMQ", "body": "This is a test email."}}' http://localhost:4000/jobs
  ```

- **μ‘μ—… μƒνƒλ³„ μ΅°ν (GET)**:
  `http://localhost:4000/jobs?status=<status>` μ—”λ“ν¬μΈνΈλ΅ `GET` μ”μ²­μ„ λ³΄λ‚΄ νΉμ • μƒνƒμ μ‘μ—…μ„ μ΅°νν•©λ‹λ‹¤. `<status>`λ” `completed`, `waiting`, `active`, `delayed`, `failed`, `paused` μ¤‘ ν•λ‚ λλ” μ½¤λ§λ΅ κµ¬λ¶„λ μ—¬λ¬ κ°κ°€ λ  μ μμµλ‹λ‹¤.

  **μμ‹ (cURL):**

  ```bash
  curl http://localhost:4000/jobs?status=waiting,active
  ```

- **μ‘μ—… μ •λ¦¬ (DELETE)**:
  `http://localhost:4000/jobs?status=<status>` μ—”λ“ν¬μΈνΈλ΅ `DELETE` μ”μ²­μ„ λ³΄λ‚΄ νΉμ • μƒνƒμ μ‘μ—…μ„ μ •λ¦¬ν•©λ‹λ‹¤. `<status>`λ” `completed`, `wait`, `active`, `delayed`, `failed` μ¤‘ ν•λ‚μ—¬μ•Ό ν•©λ‹λ‹¤.

  **μμ‹ (cURL):**

  ```bash
  curl -X DELETE http://localhost:4000/jobs?status=completed
  ```

### 2. ν μ‹κ°ν™” λ€μ‹λ³΄λ“ (Bull Board)

`dashboard` μ„λΉ„μ¤λ” `localhost:3000` ν¬νΈμ—μ„ μ‹¤ν–‰λ©λ‹λ‹¤.

- μ›Ή λΈλΌμ°μ €μ—μ„ λ‹¤μ μ£Όμ†λ΅ μ ‘μ†ν•μ—¬ Bull Board λ€μ‹λ³΄λ“λ¥Ό ν™•μΈν•  μ μμµλ‹λ‹¤.
  `http://localhost:3000/admin/queues`

μ΄ λ€μ‹λ³΄λ“λ¥Ό ν†µν•΄ νμ— λ“±λ΅λ μ‘μ—…μ λ©λ΅κ³Ό μƒνƒλ¥Ό μ‹¤μ‹κ°„μΌλ΅ λ¨λ‹ν„°λ§ν•κ³ , μ‘μ—…μ„ μ¬μ‹λ„ν•κ±°λ‚ μ‚­μ ν•λ” λ“±μ κ΄€λ¦¬λ¥Ό ν•  μ μμµλ‹λ‹¤.

## π“„ λΌμ΄μ„ μ¤

μ΄ ν”„λ΅μ νΈλ” ISC λΌμ΄μ„ μ¤λ¥Ό λ”°λ¦…λ‹λ‹¤.
